#!/bin/bash

# Install nginx with the -y flag to avoid manual confirmation during installation
apt-get update
apt-get install -y nginx

# Ensure nginx is listening on port 80
sed -i 's/80 default_server/80 default_server;/g' /etc/nginx/sites-available/default

# Restart nginx without using systemctl
/etc/init.d/nginx restart || service nginx restart

# Check if nginx is running
if pgrep -x "nginx" > /dev/null
then
    echo "Nginx is running."
else
    echo "Nginx is not running."
fi

# Create a temporary index.html file with "Hello World!" content
echo "Hello World!" > /var/www/html/index.html

# Test nginx configuration
curl -s localhost | grep "Hello World!" > /dev/null
if [ $? -eq 0 ]; then
    echo "Nginx configured successfully."
else
    echo "Nginx configuration failed."
fi
